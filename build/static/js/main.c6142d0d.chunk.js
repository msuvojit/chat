(this.webpackJsonpdra=this.webpackJsonpdra||[]).push([[0],{144:function(e,t,a){e.exports=a(224)},149:function(e,t,a){},202:function(e,t){},224:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(10),l=a.n(r),i=(a(149),a(274)),s=a(130),c=a(275),m=a(131),u=a(77),d=a.n(u),p=a(78),g=a.n(p),f=Object(m.a)({palette:{primary:d.a,secondary:g.a}}),h=a(30),x=a.n(h),v=a(52),b=a(133),E=a(81),y=a(121),k=a(122),C=a(134),w=a(132),S=a(36),j=a(277),O=a(278),D=a(225),N=a(265),B=a(266),T=a(282),I=a(267),M=a(280),z=a(276),A=a(45),R=a.n(A),W=a(127),L=a.n(W),F=a(125),H=a.n(F),P=(a(169),a(97),a(171),a(123)),U=a.n(P),q=a(281),G=a(273),K=a(271),Q=a(272),Y=a(270),J=a(124),V=a.n(J),_=Object(j.a)((function(e){return{root:{width:function(e){return e.size?e.size:"50px"},height:function(e){return e.size?e.size:"50px"},margin:"calc(1/5 * ".concat((function(e){return e.size?e.size:"50px"}),")"),backgroundColor:"#ddd",backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"cover",borderRadius:"50%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",fontSize:"calc(4/5 * ".concat((function(e){return e.size?e.size:"50px"}),")")}}})),X=function(e){var t=e.avatar,a=e.size,n=_({size:a});return"text"===t.type?o.a.createElement("div",{className:n.root,style:{backgroundColor:t.color,color:t.textColor}},t.text):o.a.createElement("div",{className:n.root,style:{backgroundImage:"url(".concat(t.img?t.img:t,")")}})},Z=Object(j.a)((function(e){return{root:{border:"1px black solid",maxWidth:"100%",borderColor:function(e){return e&&e.textColor?e.textColor:"black"},borderRadius:"5px",padding:"10px",display:"flex",flexDirection:"row",justifyContent:"space-around",alignItems:"center"},icon:{color:function(e){return e&&e.textColor&&"black"!==e.textColor?e.textColor:"#555"}},name:{color:function(e){return e&&e.textColor&&"black"!==e.textColor?e.textColor:"#555"},marginRight:"0",height:"22px",overflow:"hidden",wordBreak:"break-all",textOverflow:"ellipses"}}})),$=function(e){var t=e.file,a=e.textColor,n=e.name;"object"!==typeof t&&(t={file:t,name:n||t});var r=Z({textColor:a}),l=t.name?t.name.split("/"):"",i=n||(l.length>0?l[l.length-1]:"Uploading...");return i=i.length>33?i.substring(0,30)+"...":i,o.a.createElement(O.a,{variant:"outlined",className:r.root,component:"a",href:t.file||"",download:!0,target:"_blank",rel:"noopener noreferrer"},o.a.createElement("div",{className:r.name},i),o.a.createElement(H.a,{className:r.icon}))};var ee,te=Object(j.a)((function(e){return{root:{backgroundColor:function(t){return t&&t.color?"primary"===t.color||"secondary"===t.color?e.palette[t.color][100]:t.color:"white"},color:function(e){return e&&e.textColor?e.textColor:"black"},maxWidth:"70%",padding:"15px",borderRadius:"15px",borderBottomLeftRadius:function(e){return e&&e.left?0:null},borderBottomRightRadius:function(e){return e&&!e.left?0:null},float:function(e){return e&&e.left?null:"right"},"overflow-wrap":"break-word",width:"fit-content"},info:{display:"flex",flexDirection:"row",justifyContent:"flex-end",alignItems:"flex-end",marginTop:"7px"},title:{fontWeight:500,marginRight:"50px",fontSize:"17px",color:function(e){return e&&e.textColor?e.textColor:"black"}},sub:{fontWeight:300,fontSize:"14px",color:function(e){return e&&e.textColor?e.textColor:"black"}}}})),ae=function(e){var t=e.children,a=e.time,n=(e.name,e.left),r=e.right,l=e.color,i=e.textColor,s=te({color:l,left:n||!r,textColor:i,"overflow-wrap":"break-word"});return o.a.createElement("div",{className:s.root},t,a?o.a.createElement("div",{className:s.info},o.a.createElement("div",{className:s.sub},function(e){var t=e.getHours(),a=e.getMinutes(),n=t>=12?"pm":"am";return(t=(t%=12)||12)+":"+(a=a<10?"0"+a:a)+" "+n}(a))):null)},ne=function(e){return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"numeric",day:"numeric"})},oe=Object(j.a)((function(e){return{root:{display:"flex",flexDirection:function(e){return e&&e.left?"row":"row-reverse"},justifyContent:"flex-start",alignItems:"center",margin:"10px",position:"relative"},dateContainer:{width:"100%",position:"relative",marginBottom:"60px"},dateBox:{position:"absolute",left:"50%",transform:"translateX(-50%)",padding:"12px",backgroundColor:"#eee",fontWeight:300,borderRadius:"10px"},msgWrap:{width:"100%"}}})),re=function(e){var t=e.children,a=e.left,n=e.right,r=e.name,l=e.time,i=e.color,s=e.textColor,c=(e.avatar,e.date),m=oe({left:a||!n});return o.a.createElement(o.a.Fragment,null,c?o.a.createElement("div",{className:m.dateContainer},o.a.createElement("div",{className:m.dateBox},c.toString())):null,o.a.createElement("div",{className:m.root},o.a.createElement("div",{className:m.msgWrap},o.a.createElement(ae,{left:a,right:n,name:r,time:l,color:i,textColor:s},t))))},le=Object(j.a)((function(e){return{root:{backgroundColor:e.palette.primary[50],height:"100vh",width:"100vw",display:"flex",justifyContent:"center",alignItems:"stretch"},"@media screen and (min-width: 738px)":{root:{alignItems:"center"}},outerCard:{paddingLeft:0,paddingRight:0,minHeight:"80vh",minWidth:"50vw",maxHeight:"100vh",backgroundColor:"#eee",display:"flex",flexDirection:"column",width:"100vw"},cardActions:{flexShrink:"1",display:"flex",width:"100%",backgroundColor:"#eee",flexDirection:"row",justifyContent:"center",alignItems:"center"},sendButton:{color:"white",paddingTop:"auto",paddingBottom:"auto",margin:"10px",marginLeft:0},altButton:{paddingTop:"auto",paddingBottom:"auto",paddingLeft:"5px",paddingRight:"5px",margin:"10px",marginLeft:0,minWidth:"0"},sendMessage:{"& .MuiFilledInput-input":{paddingTop:"10px"},margin:"10px"},messageCard:{backgroundColor:"#FCEBDC",overflowY:"auto",flexGrow:"1",minHeight:"75%"},title:{fontSize:"16px",marginLeft:"5px"},header:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",color:"#777",padding:"10px",backgroundColor:"#eee",position:"fixed",top:0,left:0,right:0,"z-index":99999},grow:{flexGrow:"1"},restart:{marginRight:"20px"},emojiContainer:{position:"relative","& .emoji-picker-react":{position:"absolute",bottom:0,right:0}}}})),ie=function(e){var t=e.uid,a=e.messages,r=(e.showEmoji,e.message),l=e.setState,i=e.saveImageMessage,s=e.saveMessage,c=e.smallToken,m=e.meetingDetails,u=le(),d="";c===m.dSmallToken?d=m.patientName:c===m.pSmallToken&&(d=m.doctorName);var p=d.charAt(0)&&d.charAt(0).toUpperCase(),g=Object(n.useState)(!1),f=Object(S.a)(g,2),h=f[0],x=f[1],v=Object(n.useState)(""),b=Object(S.a)(v,2),E=b[0],y=b[1],k=Object(n.useState)(""),C=Object(S.a)(k,2),w=C[0],j=C[1],A=Object(n.useState)(""),R=Object(S.a)(A,2),W=R[0],F=R[1],H=Object(n.useState)(""),P=Object(S.a)(H,2),U=P[0],J=P[1],_=Object(n.useState)(""),Z=Object(S.a)(_,2),ee=Z[0],te=Z[1],ae=Object(n.useState)(!1),oe=Object(S.a)(ae,2),ie=oe[0],se=oe[1],ce=function(){x(!1)};return o.a.createElement("div",{className:u.root},o.a.createElement(D.a,{className:u.outerCard},o.a.createElement("div",{className:u.header},o.a.createElement(X,{size:"32px",avatar:{type:"text",text:p,color:"#ddd",textColor:"black"}}),o.a.createElement("div",{className:u.title},d),o.a.createElement("div",{className:u.grow})),o.a.createElement(N.a,{className:u.messageCard},o.a.createElement(B.a,null,o.a.createElement("div",{id:"chatList",className:u.messages,style:{paddingBottom:"50px",paddingTop:"50px"}},a.map((function(e,n){var r=ne(e.createdAt),l=n>0&&ne(a[n-1].createdAt);return o.a.createElement(re,{key:n,date:n>0&&r===l?null:r,left:!(e.sentBy===t)&&!e.sending,right:e.sentBy===t||e.sending,name:e.name,avatar:e.avatar,color:e.sending?"#ffe3e3":e.sentBy===t?"primary":null,textColor:"black"},e.file?o.a.createElement($,{name:e.text,file:e.file,textColor:"black"}):e.text)}))))),o.a.createElement("div",{className:u.cardActions,style:{position:"fixed",bottom:0}},o.a.createElement(T.a,{fullWidth:!0,variant:"filled"},o.a.createElement(I.a,{type:"text",className:u.sendMessage,value:r,onKeyDown:function(e){if(console.log(e.key),"Enter"===e.key){if(0===r.length)return;s(r)}},onChange:function(e){var t=e.target.value;return l({message:t})},placeholder:"Type a message"})),o.a.createElement(M.a,{title:"Click To Open Rx"},o.a.createElement(O.a,{className:u.altButton,color:"primary",variant:"outlined",onClick:function(){y(""),j(""),F(""),J(""),te(""),x(!0)}},"Rx")),o.a.createElement("div",null,o.a.createElement(q.a,{open:h,onClose:ce,should:!0},o.a.createElement(Y.a,{id:"form-dialog-title",style:{textAlign:"center"}},"Prescription"),o.a.createElement(K.a,{dividers:!0},o.a.createElement(Q.a,null,"Please fill the details to make a prescription and send it directly in the chat as an attachment."),o.a.createElement(z.a,{autoFocus:!0,margin:"dense",id:"symptoms",label:"Enter Symptoms",type:"text",name:"symptoms",fullWidth:!0,value:E,onChange:function(e){y(e.target.value)}}),o.a.createElement(z.a,{margin:"dense",id:"Medical History",label:"Enter Medical History",type:"text",fullWidth:!0,value:w,onChange:function(e){j(e.target.value)}}),o.a.createElement(z.a,{margin:"dense",id:"medicine",label:"Enter Medicines",type:"text",fullWidth:!0,value:W,onChange:function(e){F(e.target.value)}}),o.a.createElement(z.a,{margin:"dense",id:"lab",label:"Lab Tests (if any)",type:"text",fullWidth:!0,value:U,onChange:function(e){J(e.target.value)}}),o.a.createElement(z.a,{margin:"dense",id:"followUp",label:"Follow Up Date",type:"text",fullWidth:!0,value:ee,onChange:function(e){te(e.target.value)}})),o.a.createElement(G.a,null,o.a.createElement(O.a,{onClick:ce,color:"primary"},"Cancel"),o.a.createElement(O.a,{onClick:function(){x(!1),se(!0)},color:"primary"},"Preview")))),o.a.createElement("div",null,o.a.createElement(q.a,{open:ie,onClose:ce},o.a.createElement("div",{id:"pres"},o.a.createElement(Y.a,{id:"alert-dialog-title"},"Prescription"),o.a.createElement(K.a,{dividers:!0,id:"pres"},o.a.createElement("p",null,"SYMPTOMS: ",E),o.a.createElement("hr",null),o.a.createElement("p",null,"MEDICAL HISTORY: ",w),o.a.createElement("hr",null),o.a.createElement("p",null,"MEDICINES: ",W),o.a.createElement("hr",null),o.a.createElement("p",null,"LAB TESTS (if any): ",U),o.a.createElement("hr",null),o.a.createElement("p",null,"Follow Up Date: ",ee),o.a.createElement("hr",null))),o.a.createElement(G.a,null,o.a.createElement(O.a,{onClick:function(){y(""),j(""),F(""),J(""),te(""),se(!1)},color:"primary"},"Cancel"),o.a.createElement(O.a,{onClick:function(){se(!1),x(!0)},color:"primary"},"Edit"),o.a.createElement(O.a,{onClick:function(){V.a.toPng(document.getElementById("pres")).then((function(e){var t=document.createElement("a");t.download="prescription.png",t.href=e,t.click();var a=function(e,t){for(var a=e.split(","),n=a[0].match(/:(.*?);/)[1],o=atob(a[1]),r=o.length,l=new Uint8Array(r);r--;)l[r]=o.charCodeAt(r);return new File([l],t,{type:n})}(t.href,"prescription.png");i(a)})),se(!1)},color:"primary",autoFocus:!0},"Send")))),o.a.createElement(M.a,{title:"Click To Upload"},o.a.createElement(O.a,{className:u.altButton,color:"primary",variant:"outlined",onClick:function(){return document.getElementById("file-upload").click()}},o.a.createElement(L.a,null))),o.a.createElement("input",{id:"file-upload",type:"file",multiple:!1,style:{display:"none"},onChange:function(e){return i(e.target.files[0])}}),o.a.createElement(O.a,{className:u.sendButton,color:"primary",variant:"contained",type:"submit",onClick:function(){0!==r.length&&s(r)}},"Send"))))},se="https://notification.opdlift.com/api/chat",ce=function(e){Object(C.a)(a,e);var t=Object(w.a)(a);function a(e){var n;return Object(y.a)(this,a),(n=t.call(this,e)).scrollToBottom=function(){document.getElementById("chatList").scrollIntoView({behavior:"smooth",block:"end"})},n.addMessage=function(e){n.setState((function(t){var a=0!=t.messages.filter((function(t){return t.sending&&t.text===e.text})).length,n=e.createdAt?e:Object(E.a)(Object(E.a)({},e),{},{createdAt:new Date});return a?{messages:t.messages.map((function(t){return t.sending&&t.text===e.text?n:t}))}:{messages:[].concat(Object(b.a)(t.messages),[n])}}),(function(){n.scrollToBottom()}))},n.getDetails=Object(v.a)(x.a.mark((function e(){var t,a,o,r,l,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=n.props.match.params.token,e.next=4,R.a.post("https://notification.opdlift.com/api/agora/meeting-details",{token:t});case 4:a=e.sent,o=a.data,r=o.smallToken,l=o.meetingDetails,r===l.dSmallToken?i=l.patientName:r===l.pSmallToken&&(i=l.doctorName),n.setState({name:i}),n.setState({uid:a.data.uid,channel:a.data.channel,room:a.data.channel,token:a.data.token,smallToken:a.data.smallToken,meetingDetails:a.data.meetingDetails},(function(){(ee=U()("https://notification.opdlift.com")).emit("join",{sentBy:n.state.uid,name:n.state.name,room:n.state.room},(function(e){e&&console.error(e)})),ee.on("message",(function(e){n.addMessage(e)})),ee.on("roomData",(function(e){var t=e.users;n.setState({users:t})})),n.getMessages()})),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("err",e.t0.response);case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),n.uploadFile=function(){var e=Object(v.a)(x.a.mark((function e(t){var a,n,o,r,l,i,s,c;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=t.type,n="".concat(t.name),o={method:"post",url:"https://notification.opdlift.com/api/chat/sign-s3",headers:{"Content-Type":"application/json"},data:{fileName:n,fileType:a}},e.next=7,R()(o);case 7:return r=e.sent,l=r.data,i=l.signedRequest,s=l.url,console.log(i),c={method:"put",url:i,headers:{"Content-Type":a},data:t},e.next=13,R()(c);case 13:return r=e.sent,console.log(s),e.abrupt("return",s);case 18:e.prev=18,e.t0=e.catch(0),console.log(e.t0.response);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t){return e.apply(this,arguments)}}(),n.saveImageMessage=function(){var e=Object(v.a)(x.a.mark((function e(t){var a,o,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(new FormData).append("file",t),console.log({file:t}),n.setState({isLoading:!0}),n.addMessage({text:null,createdAt:new Date,sending:!0,file:{file:"Sending",text:"Filename"}}),e.prev=5,se+"/upload-file",e.next=9,n.uploadFile(t);case 9:return a=e.sent,console.log({res:a}),ee.emit("sendFile",n.state.channel,n.state.uid,n.state.meetingDetails.patientName,a,t.name,(function(){n.setState({message:""})})),o={room:n.state.channel,sentBy:n.state.uid,name:n.state.name,file:a,text:t.name},e.next=15,R.a.post(se+"/save-file",o);case 15:r=e.sent,console.log(r.data),n.getMessages(),n.setState({isLoading:!1}),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(5),console.log(e.t0),n.setState({isLoading:!1});case 25:case"end":return e.stop()}}),e,null,[[5,21]])})));return function(t){return e.apply(this,arguments)}}(),n.getMessages=Object(v.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.get(se+"/".concat(n.state.channel));case 3:t=e.sent,n.setState({messages:t.data},(function(){return n.scrollToBottom()})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0.response);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),n.saveMessage=function(e){n.setState({message:""}),n.state.message&&(n.addMessage({text:n.state.message,createdAt:new Date,sending:!0,file:null}),ee.emit("sendMessage",n.state.channel,n.state.uid,n.state.meetingDetails.patientName,n.state.message,(function(){n.setState({message:""}),n.scrollToBottom()})))},n.state={message:"",messages:[],showEmoji:!1,uid:"",channel:"",token:"",smallToken:"",meetingDetails:""},n}return Object(k.a)(a,[{key:"componentDidMount",value:function(){this.getDetails()}},{key:"render",value:function(){return o.a.createElement(ie,{uid:this.state.uid,messages:this.state.messages,smallToken:this.state.smallToken,meetingDetails:this.state.meetingDetails,showEmoji:this.state.showEmoji,message:this.state.message,setState:this.setState.bind(this),saveImageMessage:this.saveImageMessage.bind(this),saveMessage:this.saveMessage.bind(this)})}}]),a}(o.a.Component),me=a(128),ue=a.n(me).a.initializeApp({apiKey:"AIzaSyCVBOk70HwuqqIor4h8qCPDNkoQS_iZSOw",authDomain:"newopdlift.firebaseapp.com",databaseURL:"https://newopdlift.firebaseio.com",projectId:"newopdlift",storageBucket:"newopdlift.appspot.com",messagingSenderId:"287274948468",appId:"1:287274948468:web:dbfbe2d4a8aba2d63fbe21",measurementId:"G-3P9KH84QHQ"});ue.analytics();var de=a(129),pe=a(12);var ge=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(i.a,{utils:s.a},o.a.createElement(c.a,{theme:f},o.a.createElement(de.a,null,o.a.createElement(pe.a,{exact:!0,path:"/:token",component:ce})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(ge,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[144,1,2]]]);
//# sourceMappingURL=main.c6142d0d.chunk.js.map